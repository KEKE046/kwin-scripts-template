# Repository Guidelines

## Project Structure & Module Organization
- `src/main.ts` is the entry point for the KWin script; keep core behavior here and guard any KDE globals behind quick sanity checks if you expand functionality.
- `src/kwin.d.ts` holds the TypeScript declarations for the KWin 6 scripting API; extend it instead of scattering `any` in source files.
- `dist/` is generated by the TypeScript compiler (`tsc`) and loaded into KWin; do not hand-edit generated files.
- `scripts/` contains helper shell scripts used to load, unload, and tail logs from KWin via `qdbus6`.
- `config/` is reserved for future configuration artifacts; prefer adding new config here rather than mixing with source.

## Build, Test, and Development Commands
- `npm run compile` – build TypeScript from `src/` into `dist/`.
- `npm run start` – compile, load the built script into KWin using the package name as the plugin id, then stream the live KWin scripting log.
- `npm run unload` – remove the loaded script from KWin (useful before reloading or when debugging).
- `npm run log` – follow relevant KWin scripting logs without reloading.
- `npm run lint` – run ESLint across `src/`; treat warnings as actionable before pushing changes.

## Coding Style & Naming Conventions
- TypeScript only; target ES2020 and CommonJS in the runtime. Prefer camelCase for variables/functions and PascalCase for types.
- Favor small, pure helpers in `src/` and isolate KWin-specific calls so they are easy to stub or mock in future tests.
- Run `npm run lint -- --fix` before commits. Keep `any` usage limited to API surface already typed in `kwin.d.ts`.
- Use 2-space indentation and trailing commas only where JSON allows; keep files ASCII.

## Testing Guidelines
- No automated test harness is present. Validate changes by running `npm run start`, exercising the script in KWin, and watching `npm run log` output for errors or warnings.
- When adding behaviors, log concise context (window class, desktop id, etc.) and clean up noisy logging before submission.
- If you introduce a test setup, keep it in a top-level `tests/` directory and document the runner here.

## Commit & Pull Request Guidelines
- No historical convention exists yet; prefer short, imperative summaries (e.g., `Add window filter logging`) and consider Conventional Commit prefixes if it aids grouping.
- Keep PR descriptions focused: what changed, why it helps the script, and how it was validated (commands run, manual steps in KWin).
- Link related issues when available and include screenshots or short repro steps if the change affects visible behavior in KWin.
